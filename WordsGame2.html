<!DOCTYPE html>
<html>
<head>
	<title>Words Game</title>
</head>
<body>
	<div id=bodydiv style="    
		display: flex;
	    justify-content: center;
	    ">
		<div id=canvasdiv style="    
			width: 700px;
			height: 650px;
			display: flex;
			flex-direction: column;
			align-items: center;
		    background-color: gray;"> 
			<canvas height="600" width="600" id="myCanvas" style="border:3px solid black;
			    top: 5px;
			    position: relative;"></canvas>
			
				<br>
			<div width="600">
					<input type="text" placeholder="Type translation..." id="myInput" style="
					text-align: center;
					margin-left:14px; font-weight: bold;width: 400px; font-size: 22px;
					position: relative;
					top: -10px;" autofocus>
					
		    		<!--<button type="button" onclick="getInputValue();">Get Value </button>  -->
			</div>
			
			
		</div>
	</div>

	<!--   <script src="mydictionary.js"></script>  -->
	<script src="dict.js"></script> -->
	<script type="text/javascript">
		var coin = new Audio('../coin.wav');
		var No = new Audio('../No.wav');
		var win = new Audio('../winSong.wav');
		var ohNo = new Audio('../ohNo.wav');
		
		No.volume=0.1;
		coin.volume=0.1;
		ohNo.volume=0.5;
		win.volume=0.5;

		var ChapterNr = 3;
		var DictPage = 1;
		

		var myCanvas = document.getElementById('myCanvas').getContext('2d');
		//myCanvas.volume=0;

		var Answer;
		var guessedWrong=false;
		var WIDTH = 600;
		var HEIGHT = 600;
		var intervalVar,score;
		var maxWordInDict=0;
		TryAgainScreen = false; 
		
		var levDone= [false,0,0,0,0,0,0,0,0,0];
		//var levDone= [false,1,1,2,0,1,0,1,0,0];
		

		//Start screen
		/*
		myCanvas.font = "48px Calibri";
		myCanvas.fillText('Danish tutor',140, 200);
		
		myCanvas.font = "18px Calibri";
		myCanvas.fillText('press + or - to change chapters',160, 400);
		
		myCanvas.font = "24px Calibri";
		myCanvas.fillText('press Enter to start',160, 300);
		*/
		//---------------------------------Start Screen--------------------//

		myCanvas.font = "48px Calibri";
		myCanvas.fillText('Danish tutor',140, 200);
		
		myCanvas.font = "24px Calibri";
		myCanvas.fillText('press Enter to start',160, 300);
		myCanvas.save();

		myCanvas.font = "18px Calibri";
		myCanvas.fillText('press + or -  to change chapters',160, 400);

		myCanvas.font = "18px Calibri";
		myCanvas.fillText('press 1,2,3...9  to change pages',160, 450);

		myCanvas.font = "18px Calibri";
		myCanvas.fillText(('current page is: '+DictPage),160, 550);

		myCanvas.restore();

		//---------------------------------------------------------------------//
		

		var gameStarted = false;
		var gameInterval= 100;
		var framesPerSecond=30;

		var skoreY=30;
		var wordY=30;
		var DanNum=0; //arrays start with index 0 

		
/*
		var Danish 	=["folk"   ,"skal"    ,"flere" , "tiden"     ,"rejse",      "døde",      "om",   "kigge", "sidste","uge"  , "hvorfor","hvordan","tilføje","ting","nemlig","forsamlinger forbudt "];
		var English =["people","should","more"	   ,"the time"   ,"travel"     ,"dead",       "about","look",  "last",  "week","why"	,    "how", "add"   , "thing","exactly","gatherings forbidden"];
		var Danish2 =["det sker"  ,"med","en smule","steget"   ,"penge","dyrere"	    ,"bolig"   ,"kræver" ,"beslutning","åbne","han betaler","priserne"," falder"    ,"fortsæt"  ,"muligt"  ,"jeg mener","virkelig","første gang","spise","øjeblik","mange","meget","noget mad"];
		var English2=["it happens","with","a bit"  ,"increased","money","more expensive","property","demands","decision"  ,"open","he pays"   ,"the prices","are falling","continue","possible","I think"  ,"really"  ,"first time" ,"eat"  ,"moment"  ,"many","a lot","some food"];
		var Danish3 =["betyder","genert","larmende","sød" ,"hoppe i mudder","vindue","hurtigere","kender","sikkert", "efter","falde i søvn","egentlig","hjernen","vejr"     ,"vejret","vigtigt"];
		var English3=["means"  ,"shy"	,"noisy"	,"sweet","jump in mud","window","faster","know"		,"certainly","after","fall asleep" ,"actually","the brain","weather","the weather","important"];
		
		var Danish4 =["afskyeligt" ,"rask"   ,"Jeg ringer","prikker","ansigt","pilene","slet ikke","det blæser"  ,"vær forsigtig"   ,"tung","reddet","solskinsdag"   ,"regndag" ,"rutsjebane"    ,"stadig"  ,"flyve","vind","vente"];
		var English4 =["disgusting","healthy","I am calling","dots"	   ,"face"  ,"arrows","not at all","it blows","be careful"    ,"heavy","saved","sunny day"  ,"rainy day","rollercoaster","still","fly"   ,"wind","wait"];
		
		var Danish5 =["forsamlinger","selskabet ","ville ikke","frivilligt","halve antal"  ,"antal passagerne"	,"anbefalingerne","to meters","afstand","undgå ","tæt  ","kontakt  ","at forhindre"," smitte"];
		var English5 =["gatherings","the company","would not","voluntary","half the number","number of passengers","recommendations","two meters","away","avoid","close","contact","to prevent","infection"];
		
		var Danish6 =["prøv igen","sjovt","endelig","beskytter","vente","udtaler"	  ,""];
		var English6 =["try again","fun","finally","protects"  ,"wait","pronunciation",""];

		var Danish7 =["hvem er det","klar","hemmelig","hemmelig ting","dejlig","dårlig","nok","hvor gammel","Jeg hvisker","Jeg keder mig","valg","stue"			,"tillyke","Tillyke med fødselsdagen"];
		var English7 =["who is it" ,"ready","secret","secret stuff","nice","bad","enough"    ,"how old"    ,"I whisper","I am bored"   ,"choise","living room"	,"congratulations","Happy birthday"];
		
		var Danish8 =["hide der","gensidig","spændende","ballade","side om side","afholde fest","fint nok","frisk"  ,"fisk","vildsvin"];
		var English8 =["right there","mutual","exciting","trouble","side by side","hold a party","good enough","fresh","fish","wild pig"];

		var Danish9 =["hvem er det?","hvor er du?","hvad","hvorfor","hvordan","hvilken","hvornår","hvor meget?","hvor mange?"];
		var English9 =["who is it?","where are you?","what","why","how"		,"which","when"		,"how much?"	,"how many?"];
*/
		document.getElementById('myCanvas').onmousedown= function(){
			if (gameStarted==false){
				startGame();
				 document.getElementById("myInput").value='';
			}
		}

		document.onkeydown = function(event) {
			if ((gameStarted==false)&&(event.keyCode ==49)) {changePage(1);}
			if ((gameStarted==false)&&(event.keyCode ==50)) {changePage(2);}
			if ((gameStarted==false)&&(event.keyCode ==51)) {changePage(3);}
			if ((gameStarted==false)&&(event.keyCode ==52)) {changePage(4);}
			if ((gameStarted==false)&&(event.keyCode ==53)) {changePage(5);}
			if ((gameStarted==false)&&(event.keyCode ==54)) {changePage(6);}
			if ((gameStarted==false)&&(event.keyCode ==55)) {changePage(7);}
			if ((gameStarted==false)&&(event.keyCode ==56)) {changePage(8);}
			if ((gameStarted==false)&&(event.keyCode ==57)) {changePage(9);}
			//if ((gameStarted==false)&&(event.keyCode ==48)) {changePage(10);}

			if ((gameStarted==false)&&(event.keyCode ==187)) {ChapterNr++;drawRects();drawHomeRect(ChapterNr);};
			if ((gameStarted==false)&&(event.keyCode ==189)) {ChapterNr--;drawRects();drawHomeRect(ChapterNr);};
				
			if ((gameStarted==false)&&(event.keyCode ==13)){ //enter
				document.getElementById("myInput").value='';
				startGame();
			
			//Enter
			}else if (event.keyCode ==13){//enter
				getInputValue();
			};
			if ((gameStarted==true)&&(event.keyCode ==27)){ //Esc
				tryAgain();
				gameReset();
			}
			if ((TryAgainScreen==true)&&(event.keyCode ==89)) {GoToYoutube();}//Y
			
		}
		function changePage(page){
			 DictPage=page;
			 console.log('DictPage='+page);
			 

			 		//var inputVal2 = document.getElementById("myInput").value;
					
					myCanvas.fillRect(0,0,WIDTH,HEIGHT);  //draw black canvas 
					myCanvas.save();
					myCanvas.fillStyle = 'Orange';
					myCanvas.font = "24px Calibri";

					myCanvas.fillText('DictPage changed to:'+DictPage,140, 550);
					myCanvas.restore();

					//document.getElementById("myInput").value='';
		}

		function getInputValue(){ //Function is called on pressing Enter
            // Selecting the input element and get its value 
            var inputVal = document.getElementById("myInput").value;
            Answer=inputVal;
            console.log("Your answer: "+inputVal);
            document.getElementById("myInput").value='';//clear prompt field
           
           if (checkAnswer()==true) {
           			wordRight();
		        }else{
		        	wordWrong();
		        }        
		}

        checkAnswer = function(){
        	let AnswerLow=Answer.toLowerCase();
        	let ctAnswerLow=currentAnswer.toLowerCase();
        	return (AnswerLow==ctAnswerLow);
       }
	   
	   


        wordWrong = function(){
	        	guessedWrong=true;
	        	No.play();
	        	score--;
        }
        wordRight = function(){
        	//word is guessed right
	           	
	           	coin.play();
	           	//alert(inputVal+" is Right!!!");
	           	score++;
	           	DanNum++;
	           	//console.log("Danish.length: "+Danish.length);

	           	console.log("DanNum: "+DanNum);
	           	wordY=0;
				   guessedWrong=false;
				   setCurrentWord();
	           	//document.getElementById("myInput").value='';
        }
		
		drawScore = function (){
			myCanvas.save();
			myCanvas.fillStyle = "white";
			myCanvas.fillText("Score:"+score, 420, skoreY);
			myCanvas.restore();

		}
		setCurrentWord= function(){
			let ni=0;
			let currentWordNumber=0;
			let currentDictPage=1;
			let currentDictChapter=1;
			maxWordInDict=0;
			for (let chapter in dict ){
				if (currentDictChapter==ChapterNr){
					console.log('right chapter');
				
				for (let page in dict[chapter]){
					if (currentDictPage==(DictPage)){
						console.log("right chapter!");
						for(let dan in dict[chapter][page] ){
							//here we iterate an object, and if number of object property is the same as DanNum , we show it
							if (currentWordNumber==DanNum){
									currentWord=dan;
									currentAnswer=dict[chapter][page][dan];
									//myCanvas.fillText(currentAnswer, i, wordY+50);//draws answer
									//i+=150;
									
							}
								currentWordNumber++;
								if(currentWordNumber>maxWordInDict){
										
										maxWordInDict=currentWordNumber
										console.log("maxWordInDict is set to:"+maxWordInDict);
									};
					}

							
						}else{console.log('Wrong dict page');}
						currentDictPage++;

						//console.log("dict:"+dict);
						//console.log("DictPage:"+DictPage);
						
					}
			}else(currentDictChapter++);
			}


		}
		drawWord = function (){
			//here we need to draw a word, according to the current word number(DanNum)
			let i=250;
			myCanvas.save();
			myCanvas.fillStyle = "white";
			myCanvas.fillText("Word:"+ currentWord, i, wordY);

			
			wordY++;//moves word position
			if (wordY>600){
				DanNum++;
				wordY=0;
				score=score-2;
				document.getElementById("myInput").value='';//clear prompt field
				ohNo.play();
				setCurrentWord();
				guessedWrong=false;
			}
			myCanvas.restore();

		}
		drawAnswer = function (){
			if (guessedWrong==true){
				myCanvas.save();
				myCanvas.fillStyle = "white";
				{myCanvas.fillText("Answer: "+currentAnswer, 10, skoreY);}
				myCanvas.restore();
		}

		}
		

		isGameOver = function() {
			
			if (DanNum == dictLength()){gameOver();}
			
		}
		dictLength = function(){
			//console.log("maxWordInDict:"+maxWordInDict)
			return maxWordInDict;

		}

		
		gameOver = function (){

					if (score >= DanNum){
						youWon();
					}else{   tryAgain();	}
					
				gameReset();
				return;
		}
		gameReset = function(){

					gameStarted=false;
					score=0;
					DanNum=0;
					console.log("clear interval");
					clearInterval(intervalVar);// this stops programm
		}
		youWon = function(){
					TryAgainScreen=true; 
					gameStarted=false;
					myCanvas.save();
					levDone[DictPage]=2;
					drawCoin();
					myCanvas.fillStyle = 'Orange';
					myCanvas.font = "24px Calibri";
					myCanvas.fillText(score +' out of '+DanNum,140, 150);
					myCanvas.fillText('Perfect score, you won!',100, 250);
					myCanvas.fillText('Press 1, 2 or 3 to change Page of Dictionary', 100, 350);
					myCanvas.fillText('Current Page:'+DictPage,140, 450);
					myCanvas.restore();
					win.play();

		}
		tryAgain =function(){
			TryAgainScreen=true; 
			gameStarted=false;
			//location.assign("https://www.w3schools.com");
			//if (confirm("Page will be redirected")){	location.assign("https://www.w3schools.com");}	  
					//location.assign("https://www.w3schools.com");// not work
					//window.location.href = "http://www.w3schools.com";
					//window.location = "http://www.example.com"; //works
					//window.location = "https://www.youtube.com/watch?v=a58Phhm8kuI&ab_channel=B%C3%B8rneTV"; 
				
					myCanvas.save();
					myCanvas.fillStyle = 'Orange';
					myCanvas.font = "24px Calibri";
					myCanvas.fillText(score +' out of '+DanNum,140, 150);
					
					if (score >= (DanNum-2)){
						win.play();
						levDone[DictPage]=1;
						drawCoin();
						myCanvas.fillText('Nice try, press Enter to try again',100, 250);
					}
						else
					myCanvas.fillText('Not perfect, press Enter to try again',100, 250);
					myCanvas.fillText('Press 1, 2 or 3 to change Page of Dictionary', 100, 350);
					myCanvas.fillText('Current Page:'+DictPage,140, 450);
					myCanvas.fillText('Press Y to wach a cartoon', 100, 550);//will fire GoToYoutube function
					myCanvas.restore();
		}
		GoToYoutube = function(){

			window.alert("Page="+DictPage+"   "+"Chapter="+ChapterNr);
				//window.location = "https://www.youtube.com/watch?v=a58Phhm8kuI&ab_channel=B%C3%B8rneTV"; 
			if ((ChapterNr==1)&&(DictPage==2))
				{window.location = "https://youtu.be/nhb89cifxW8?t=16";} 
			else if ((ChapterNr==1)&&(DictPage==3))
				{window.location = "https://youtu.be/a58Phhm8kuI";} 
			else if ((ChapterNr==1)&&(DictPage==6))
				{window.location = "https://youtu.be/zgKECHrWpU4";} 
			//if ((ChapterNr==1)&&(DictPage==6))
			//	{window.location = "https://youtu.be/zgKECHrWpU4";} 
			else if ((ChapterNr==1)&&(DictPage==9))
				{window.location = "https://youtu.be/iolFBh6OrTA?t=17";} 
			else if ((ChapterNr==2)&&(DictPage==1))
				{window.location = "https://www.youtube.com/watch?v=T0MwtvJjHfM&t=2s&ab_channel=B%C3%B8rneTV";} 
			else if ((ChapterNr==2)&&(DictPage==3))
				{window.location = "https://www.youtube.com/watch?v=ACGNuROv4p0&ab_channel=PeterMains";} 
			else if ((ChapterNr==2)&&(DictPage==5))
				{window.location = "https://youtu.be/HtkHSWG9Ti0";} 
			else if ((ChapterNr==3)&&(DictPage==1))
				{window.location = "https://youtu.be/dvavLd3Xq5Y";} 
				else{window.alert("no youtube video for this page");}
				
		}
		/*
		redirectF = function(){
			console.log("redirectF");
			location.assign("https://www.w3schools.com");
		}
		*/
		drawCoin = function(){
			

			ldl=levDone.length;
			
			coinX=575;
			cDist=45;
			for (i = 1; i < ldl; i++){
				if (levDone[i]==1){
				drawCoinFx((coinX),i*cDist-20,"silver");
				}else if(levDone[i]==2){drawCoinFx((coinX),i*cDist-20,"gold");}

			}
			
		}
		drawCoinFx = function(x,y,color){
			var c = document.getElementById("myCanvas");
				var ctx = c.getContext("2d");

				ctx.strokeStyle = color;
				ctx.lineWidth = 14;

				ctx.beginPath();
				ctx.arc(x, y, 10, 0, 2 * Math.PI);
				ctx.stroke();
				//-------------------------
				ctx.strokeStyle = "dimgray";
				ctx.lineWidth = 2;

				ctx.beginPath();
				ctx.arc(x, y, 17, 0, 2 * Math.PI);
				ctx.stroke();

		}
		function drawRects(){
			for (let rn=1;rn<=10;rn++ )
			drawRect(30,40*rn+10,"dimgray")
		}
		function drawHomeRect(rectNum){

			drawRect(30,40*rectNum+10,"silver");

		}
		function drawRect(x,y,color){
			    
				let c = document.getElementById("myCanvas");
				var ctx = c.getContext("2d");
				ctx.strokeStyle = color;
				ctx.beginPath();
				ctx.rect(x, y, 30, 30);
				ctx.stroke();


		}

		gameLoop = function(){			
			myCanvas.fillRect(0,0,WIDTH,HEIGHT);  //draw black canvas 
			//myCanvas.clearRect(0,0,WIDTH,HEIGHT);
			drawRects();
			drawHomeRect(ChapterNr);
			drawScore();
			drawCoin();
			drawWord();
			
			drawAnswer();
			isGameOver();
		}


		startGame = function(){
			setCurrentWord();
			gameStarted=true;
			TryAgainScreen=false;
			score =0;wordY=0;
			
			intervalVar = setInterval(gameLoop,1000/framesPerSecond);//30 frames
			}
		
		


	</script>


</body>
</html>